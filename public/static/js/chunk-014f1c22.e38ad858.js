(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-014f1c22"],{"12de":function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"b",function(){return o});var s=n("b775");function r(t){return Object(s["a"])({url:"/admin/theme/list",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/admin/theme/addOrUpdate",method:"post",data:t})}function o(t){return Object(s["a"])({url:"/admin/theme/homeInfo",method:"get",params:t})}},"63e8":function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return u});var s=n("b775");function r(t){return Object(s["a"])({url:"/admin/resources/list",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/admin/resources/addOrUpdate",method:"post",data:t})}function o(t){return Object(s["a"])({url:"/admin/resources/delete",method:"post",data:t})}function a(t){return Object(s["a"])({url:"/admin/resources/assignToRole",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/admin/resources/assignToUser",method:"post",data:t})}},7252:function(t,e,n){"use strict";var s=n("f353"),r=n.n(s);r.a},"7abe":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg"},[s("el-menu",{staticClass:"el-menu-demo",style:{top:t.showTopBar?0:"-50px"},attrs:{mode:"horizontal","background-color":"#303133","text-color":"#F2F6FC","active-text-color":"#FFFFFF"}},[s("div",{staticClass:"avatar fl"},[s("img",{attrs:{src:n("4ffd")}}),t._v(" "),s("b",[t._v("数据管理系统")])]),t._v(" "),s("div",{staticClass:"avatar",on:{click:t.fullscreen}},[s("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{"icon-class":"screen"}}),t._v("   全屏")],1),t._v(" "),s("el-submenu",{attrs:{index:"2"}},[s("template",{slot:"title"},[t._v(t._s(t.$store.state.user.themeInfo.theme_name))]),t._v(" "),t._l(t.themeList,function(e,n){return s("el-menu-item",{key:e.id,attrs:{index:"2-"+n},on:{click:function(){return t.switchTheme(n)}}},[t._v(t._s(e.theme_name)+"\n            ")])})],2),t._v(" "),s("div",{staticClass:"avatar",on:{click:function(){t.changeMenu(t.homeResources)}}},[s("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{"icon-class":"home"}}),t._v("   首页")],1),t._v(" "),s("div",{ref:"dashboard",staticClass:"avatar user-info"},[s("svg-icon",{attrs:{"icon-class":"user"}}),t._v("    \n            "),s("b",[t._v(t._s(t.$store.state.user.userInfo.user_name))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.dashboard_visiable,expression:"dashboard_visiable"}],staticClass:"dashboard"},[s("div",[t._v("工号："),s("b",[t._v(t._s(t.$store.state.user.userInfo.user_no))])]),t._v(" "),s("div",[t._v("公司："),s("b",[t._v(t._s(t.$store.state.user.userInfo.company_desc?t.$store.state.user.userInfo.company_desc:"未知"))])]),t._v(" "),s("div",[t._v("部门："),s("b",[t._v(t._s(t.$store.state.user.userInfo.department_desc?t.$store.state.user.userInfo.department_desc:"未知"))])]),t._v(" "),s("div",[t._v("当前IP："),s("b",[t._v(t._s(t.ip_address))])]),t._v(" "),s("div",[t._v("上次登录时间："),s("b",[t._v(t._s(t.$store.state.user.userInfo.last_login))])]),t._v(" "),s("div",[s("el-button",{attrs:{type:"text"},on:{click:t.login}},[s("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{"icon-class":"admin"}}),t._v("   登录后台")],1)],1)])],1),t._v(" "),s("div",{staticClass:"avatar",on:{click:t.logout}},[s("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{"icon-class":"logout"}}),t._v("   退出")],1)],1),t._v(" "),s("el-menu",{staticClass:"el-menu-vertical-demo",style:{left:t.showMenu?0:"-250px",top:t.showTopBar?"50px":0,height:t.showTopBar?"calc(100vh - 50px)":"100vh"},attrs:{"default-active":"2","background-color":"#303133","text-color":"#F2F6FC","active-text-color":"#FFFFFF","unique-opened":!0}},[s("el-menu-item",t._l(t.menuList,function(e,n){return s("el-submenu",{key:e.id,attrs:{index:n.toString()}},[s("template",{slot:"title"},[s("span",[t._v(t._s(e.menu_title))])]),t._v(" "),t._l(e.children,function(e,r){return s("el-submenu",{key:e.id,attrs:{index:n+"-"+r}},[s("template",{slot:"title"},[t._v(t._s(e.menu_title))]),t._v(" "),t._l(e.children,function(e,i){return s("el-menu-item",{key:e.id,attrs:{index:n+"-"+r+"-"+i},on:{click:function(){return t.changeMenu(e)}}},[t._v("\n                    "+t._s(e.menu_title))])})],2)})],2)}),1),t._v(" "),s("div",{staticClass:"icon-1",on:{click:function(){return t.showMenu=!t.showMenu}}},[t.showMenu?s("i",{staticClass:"el-icon-arrow-left"}):s("i",{staticClass:"el-icon-arrow-right"})])],1),t._v(" "),t.isFree?[t.iframeUrl?s("iframe",{style:{width:"100vw",height:t.showTopBar?"calc(100vh - 50px)":"100vh",marginTop:t.showTopBar?"50px":0},attrs:{src:t.iframeUrl,frameborder:"0"}}):s("div",{staticClass:"empty"},[s("svg-icon",{staticStyle:{"font-size":"80px"},attrs:{"icon-class":"empty"}}),t._v(" "),s("p",[t._v("当前页面为空，请联系管理员重新设置")])],1)]:s("div",{ref:"vizContainer",style:{width:"100vw",height:t.showTopBar?"calc(100vh - 50px)":"100vh",marginTop:t.showTopBar?"50px":0}})],2)},r=[],i=(n("6b54"),n("63e8"),n("c24f")),o=n("12de"),a=n("0feb"),u=(n("50fc"),n("b012"),n("ed08")),c={data:function(){return{iframeUrl:"",menuList:[],showMenu:!0,showTopBar:!0,themeList:[],ip_address:"",homeResources:null,isFree:!1,dashboard_visiable:!1}},mounted:function(){var t=this;this.render(),this.init(),this.$refs.dashboard.addEventListener("mouseenter",function(){t.dashboard_visiable=!0}),this.$refs.dashboard.addEventListener("mouseover",function(){t.dashboard_visiable=!0}),this.$refs.dashboard.addEventListener("mouseout",function(){t.dashboard_visiable=!1})},beforeDestroy:function(){document.onfullscreenchange=null},methods:{init:function(){var t=this;document.onfullscreenchange=function(){t.showTopBar||(t.showTopBar=!0)},Object(i["d"])({id:this.$store.state.user.userInfo.id}).then(function(e){t.themeList=e.data}),Object(u["b"])().then(function(e){t.ip_address=e})},render:function(){var t=this;Object(o["b"])({theme_id:this.$store.state.user.themeInfo.id}).then(function(e){if(!e.data)return t.isFree=!0,void(t.iframeUrl="");t.homeResources=e.data,t.changeMenu(e.data)}),Object(i["b"])({id:this.$store.state.user.userInfo.id,theme_id:this.$store.state.user.themeInfo.id,tree:1}).then(function(e){t.menuList=e.data})},login:function(){var t=this;this.loading=this.$loading(),this.$store.dispatch("admin/login",{user_no:this.$store.state.user.userInfo.user_no.toString(),theme_id:this.$store.state.user.themeInfo.id}).then(function(){t.loading.close(),t.$store.dispatch("permission/generateRoutes",t.$store.state.admin.roles).then(function(e){t.$router.addRoutes(e),t.password="",t.$router.push({path:"/admin/menu/resources/configuration"})})}).catch(function(e){t.loading.close()})},logout:function(){clearInterval(this.timer),this.$store.dispatch("user/logout"),this.$router.push({path:"/login"})},changeMenu:function(t){var e=this;if(!t)return this.isFree=!0,void(this.iframeUrl="");document.title=t.menu_title,clearInterval(this.timer);var n=t.links,s=0;n&&0!=n.length&&(1==n.length&&this.changeLink(n[0]),n.length>1&&(this.changeLink(n[s++]),this.timer=setInterval(function(){s>=n.length&&(s=0),e.changeLink(n[s]),s++},2e4)))},changeLink:function(t){var e=this;if(!t.origin)return this.isFree=!0,void this.$nextTick(function(){e.iframeUrl=t.url});this.isFree=!1,this.$nextTick(function(){e.$refs.vizContainer.innerHTML="";var n=window.document.createElement("div");e.$refs.vizContainer.appendChild(n);var s={width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight,hideTabs:!0,onFirstInteractive:function(){l(),setInterval(d,18e5)}},r=t.url.slice(t.url.indexOf("views/")+6);e.getToken(t.verify_account).then(function(t){var i="http://192.172.1.240/trusted/".concat(t,"/t/HC_Tableau_Server/views/").concat(r);window.viz=new window.tableau.Viz(n,i,s),window.viz.addEventListener(window.tableau.TableauEventName.STORY_POINT_SWITCH,l),e.showMenu=!1})})},fullscreen:function(){var t=this;document.documentElement.requestFullscreen(),setTimeout(function(){t.showTopBar=!1},500)},switchTheme:function(t){var e=this;clearInterval(this.timer),this.$store.dispatch("user/switchTheme",this.themeList[t]).then(function(){e.render()})},getToken:function(t){var e=this;return new Promise(function(n){Object(a["a"])({ip:e.ip_address,account:t}).then(function(t){n(t.data)})})}}};function d(){console.log("12"),window.viz.refreshDataAsync()}function l(t){var e=moment().subtract(2,"days"),n=window.viz.getWorkbook();n.getActiveSheet();n.changeParameterValueAsync("开始日期",new Date(Date.UTC(e.format("YYYY"),0,"1"))),console.log(new Date(Date.UTC(moment().format("YYYY"),moment().format("MM")-1,moment().format("DD")))),n.changeParameterValueAsync("结束日期",new Date(Date.UTC(moment().format("YYYY"),moment().format("MM")-1,moment().format("DD"))))}var h=c,m=(n("7252"),n("2877")),f=Object(m["a"])(h,s,r,!1,null,null,null);e["default"]=f.exports},b012:function(t,e){function n(t,e,n){var s,r,i,o,a;function u(){var c=Date.now()-o;c<e&&c>=0?s=setTimeout(u,e-c):(s=null,n||(a=t.apply(i,r),i=r=null))}null==e&&(e=100);var c=function(){i=this,r=arguments,o=Date.now();var c=n&&!s;return s||(s=setTimeout(u,e)),c&&(a=t.apply(i,r),i=r=null),a};return c.clear=function(){s&&(clearTimeout(s),s=null)},c.flush=function(){s&&(a=t.apply(i,r),i=r=null,clearTimeout(s),s=null)},c}n.debounce=n,t.exports=n},c24f:function(t,e,n){"use strict";n.d(e,"e",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"g",function(){return o}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return u}),n.d(e,"d",function(){return c}),n.d(e,"f",function(){return d});var s=n("b775");function r(t){return Object(s["a"])({url:"/admin/user/list",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/admin/user/add",method:"post",data:t})}function o(t){return Object(s["a"])({url:"/admin/user/update",method:"post",data:t})}function a(t){return Object(s["a"])({url:"/admin/user/listResources",method:"get",params:t})}function u(t){return Object(s["a"])({url:"/admin/user/listRole",method:"get",params:t})}function c(t){return Object(s["a"])({url:"/home/user/listTheme",method:"get",params:t})}function d(t){return Object(s["a"])({url:"/admin/employee/search",method:"get",params:t})}},f353:function(t,e,n){}}]);