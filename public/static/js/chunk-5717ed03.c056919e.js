(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5717ed03"],{"0c9f":function(t,e,n){"use strict";var i=n("ec22"),s=n.n(i);s.a},"8b28":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"head"},[n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(){t.showDialog(1)}}},[t._v("添加管理员")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.adminList,"cell-class-name":"cell"}},[n("el-table-column",{attrs:{prop:"user_no",width:"110px",label:"工号"}}),t._v(" "),n("el-table-column",{attrs:{prop:"user_name",label:"姓名"}}),t._v(" "),n("el-table-column",{attrs:{prop:"company_desc",label:"公司"}}),t._v(" "),n("el-table-column",{attrs:{prop:"department_desc",label:"部门"}}),t._v(" "),n("el-table-column",{attrs:{prop:"email",width:"80px",label:"是否启用"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{value:1==t.row.status,"active-color":"#13ce66","inactive-color":"#ff4949"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"last_login",label:"最后登录时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.parseTime(e.row.update_time,"{y}-{m}-{d}"))+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"update_time",label:"创建时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t.parseTime(e.row.update_time,"{y}-{m}-{d}"))+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"260px"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(){return t.changePermission(e.row)}}},[t._v("\n                    权限设置\n                ")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(){return t.showDialog(2,e.row)}}},[t._v("\n                    编辑\n                ")]),t._v(" "),n("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(){return t.remove(e.row.id)}}},[t._v("\n                    删除\n                ")])]}}])})],1),t._v(" "),n("el-dialog",{attrs:{title:t.formTitle,visible:t.dialogFormVisible,width:"400px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[n("div",{staticClass:"tips"},[t._v("提示: 管理员必须是当前租户下的用户。")]),t._v(" "),n("el-form",{attrs:{"label-width":"80px",width:"240px"}},[n("el-form-item",{attrs:{label:"用户"}},[n("el-select",{attrs:{disabled:t.adminForm.id,value:t.adminForm.user_name,placeholder:"选择用户"},on:{change:function(e){t.adminForm=t.userList[e]}}},t._l(t.userList,function(t,e){return n("el-option",{key:t.id,attrs:{label:t.user_name,value:e}})}),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"登录密码"}},[n("el-input",{attrs:{type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",disabled:!(t.adminForm.id&&t.password)},on:{click:function(){t.submitForm()}}},[t._v("保 存")])],1)],1)],1)},s=[],a=n("50fc"),o=n("c24f"),r=n("ed08"),l=n("4be7"),u={name:"Admin",data:function(){return{adminList:[],userList:[],formTitle:"",dialogFormVisible:!1,password:"",adminForm:{}}},mounted:function(){var t=this;o["e"]({theme_id:this.$store.state.admin.themeInfo.id}).then(function(e){t.userList=e.data}),this.init()},methods:{parseTime:r["d"],init:function(){var t=this;return new l["Promise"](function(e){a["e"]({theme_id:t.$store.state.admin.themeInfo.id}).then(function(n){t.adminList=n.data,e()})})},changePermission:function(t){this.$router.push({path:"/admin/setting/adminAuth",query:{name:t.user_name,id:t.id}})},showDialog:function(t,e){1==t?(this.formTitle="新增管理员",this.adminForm={},this.password="",this.dialogFormVisible=!0):2==t&&(this.formTitle="编辑管理员: ".concat(e.user_name),this.adminForm=e,this.password="",this.dialogFormVisible=!0)},submitForm:function(){var t=this;if(!this.password)return this.$message({message:"登录密码不能为空",type:"warning"});var e=this.adminForm,n=e.user_no,i=e.user_name,s=e.email,o=e.department,r=e.department_desc,l=e.company,u=e.company_desc,c=e.job,d=e.job_desc;this.loading=this.$loading({lock:!0}),a["a"]({theme_id:this.$store.state.admin.themeInfo.id,user_no:n,user_name:i,email:s,department:o,department_desc:r,company:l,company_desc:u,job:c,job_desc:d,password:this.password}).then(function(){t.init().then(function(e){t.loading.close(),t.dialogFormVisible=!1,t.$message({message:"创建管理员成功",type:"success"})})})},remove:function(t){var e=this;a["i"]({id:t,theme_id:this.$store.state.admin.themeInfo.id}).then(function(t){e.init().then(function(){e.$message({message:"删除成功",type:"success"})})})}}},c=u,d=(n("0c9f"),n("2877")),m=Object(d["a"])(c,i,s,!1,null,"5b5931f8",null);e["default"]=m.exports},c24f:function(t,e,n){"use strict";n.d(e,"e",function(){return s}),n.d(e,"a",function(){return a}),n.d(e,"g",function(){return o}),n.d(e,"b",function(){return r}),n.d(e,"c",function(){return l}),n.d(e,"d",function(){return u}),n.d(e,"f",function(){return c});var i=n("b775");function s(t){return Object(i["a"])({url:"/admin/user/list",method:"get",params:t})}function a(t){return Object(i["a"])({url:"/admin/user/add",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/admin/user/update",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/admin/user/listResources",method:"get",params:t})}function l(t){return Object(i["a"])({url:"/admin/user/listRole",method:"get",params:t})}function u(t){return Object(i["a"])({url:"/home/user/listTheme",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/admin/employee/search",method:"get",params:t})}},ec22:function(t,e,n){}}]);